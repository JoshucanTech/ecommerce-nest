enum PermissionAction {
  VIEW
  CREATE
  EDIT
  DELETE
  MANAGE
  APPROVE
  REJECT
  EXPORT
  IMPORT
}

enum PermissionResource {
  USERS
  VENDORS
  RIDERS
  ORDERS
  PRODUCTS
  DELIVERIES
  PAYMENTS
  ANALYTICS
  SETTINGS
  PERMISSIONS
  ROLES
  SUB_ADMINS
  SUPPORT_TICKETS
  ADVERTISEMENTS
  CATEGORIES
  REVIEWS
}

model Role {
  id          String           @id @default(uuid())
  name        String           @unique
  description String?
  isActive    Boolean          @default(true)
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  permissions RolePermission[]
  users       User[]           @relation("UserRoles")

  @@map("roles")
}

model Permission {
  id          String             @id @default(uuid())
  name        String             @unique
  description String?
  action      PermissionAction
  resource    PermissionResource
  scope       Json?              // { type: 'GEOGRAPHIC' | 'ORGANIZATIONAL', value: {...} }
  level       Int                @default(0) // Hierarchy level (0 = lowest)
  category    String?            // Group permissions (e.g., 'User Management', 'Content')
  conditions  Json?              // Advanced rules (time-based, conditional)
  isActive    Boolean            @default(true)
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt
  roles       RolePermission[]

  @@index([resource, action])
  @@map("permissions")
}

model RolePermission {
  roleId       String
  permissionId String
  permission   Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)
  role         Role       @relation(fields: [roleId], references: [id], onDelete: Cascade)

  @@id([roleId, permissionId])
  @@map("role_permissions")
}
