model Order {
  id                String           @id @default(uuid())
  orderNumber       String           @unique
  userId            String
  vendorId          String?
  tax               Float            @default(0)
  shipping          Float?
  totalAmount       Float
  status            OrderStatus      @default(PENDING)
  paymentStatus     PaymentStatus    @default(PENDING)
  paymentMethod     String
  addressId         String?
  couponId          String?
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  actualDelivery    DateTime?
  couponCode        String?
  deletedAt         DateTime?
  estimatedDelivery DateTime?
  notes             String?
  riderId           String?
  shippingAddressId String?
  shippingCost      Float            @default(0)
  subtotal          Float            @default(0)
  total             Float            @default(0)
  trackingNumber    String?
  paymentIntentId   String?
  transactionRef    String?
  delivery          Delivery?
  notifications     Notification[]
  items             OrderItem[]
  OrderShipping     OrderShipping[]
  address           Address?         @relation(fields: [addressId], references: [id])
  coupon            Coupon?          @relation(fields: [couponId], references: [id])
  Rider             Rider?           @relation(fields: [riderId], references: [id])
  shippingAddress   ShippingAddress? @relation(fields: [shippingAddressId], references: [id])
  user              User             @relation("UserOrders", fields: [userId], references: [id], onDelete: Cascade)
  vendor            Vendor?          @relation("VendorOrders", fields: [vendorId], references: [id])
  payment           Payment[]

  @@map("orders")
}

model OrderItem {
  id             String          @id @default(uuid())
  orderId        String
  productId      String
  quantity       Int
  unitPrice      Float
  totalPrice     Float
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  shippingId     String?
  shippingStatus ShippingStatus  @default(PROCESSING)
  userId         String?
  variantId      String?
  order          Order           @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product        Product         @relation(fields: [productId], references: [id])
  shipping       Shipping?       @relation(fields: [shippingId], references: [id])
  User           User?           @relation(fields: [userId], references: [id])
  variant        ProductVariant? @relation(fields: [variantId], references: [id])

  @@map("order_items")
}

enum OrderStatus {
  PENDING
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
  REFUNDED
  CONFIRMED
  OUT_FOR_DELIVERY
}
