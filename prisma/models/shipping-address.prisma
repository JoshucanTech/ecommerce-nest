model ShippingAddress {
  id           String            @id @default(uuid())
  street       String
  city         String
  state        String
  postalCode   String
  country      String
  latitude     Float?
  longitude    Float?
  isDefault    Boolean           @default(false)
  nickname     String?
  addressType  AddressType       @default(OTHER)
  userId       String
  createdAt    DateTime          @default(now())
  updatedAt    DateTime          @updatedAt
  lastUsed     DateTime?
  useCount     Int               @default(0)
  sharedFromId String?
  firstName    String            @default("")
  lastName     String            @default("")
  phone        Int               @default(0)
  orders       Order[]
  sharedWith   SharedAddress[]
  sharedFrom   ShippingAddress?  @relation("SharedAddressRelation", fields: [sharedFromId], references: [id])
  sharedCopies ShippingAddress[] @relation("SharedAddressRelation")
  user         User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([country, postalCode])
  @@map("shipping_addresses")
}

model SharedAddress {
  id           String          @id @default(uuid())
  sharedById   String
  sharedWithId String
  addressId    String
  canEdit      Boolean         @default(false)
  expiresAt    DateTime?
  address      ShippingAddress @relation(fields: [addressId], references: [id])
  sharedBy     User            @relation("SharedByUser", fields: [sharedById], references: [id])
  sharedWith   User            @relation("SharedWithUser", fields: [sharedWithId], references: [id])

  @@unique([addressId, sharedWithId])
  @@map("shared_addresses")
}

enum AddressType {
  HOME
  WORK
  GIFT
  BUSINESS
  OTHER
}
