model Product {
  id                    String                  @id @default(uuid())
  name                  String
  description           String
  price                 Float
  discountPrice         Float?
  quantity              Int                     @default(0)
  sku                   String                  @unique
  images                String[]
  isPublished           Boolean                 @default(false)
  vendorId              String
  slug                  String                  @unique
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt
  attributes            Json?
  metaDescription       String?
  metaTitle             String?
  tags                  String[]
  shippingPolicyId      String?
  returnPolicy          String?
  soldCount             Int                     @default(0)
  viewCount             Int                     @default(0)
  warrantyInfo          String?
  shortDescription      String?
  userInteractions      AdUserInteraction[]
  advertisements        ProductAdvertisement[]
  ProductVariant        ProductVariant[]
  cartItems             CartItem[]
  comments              Comment[]
  flashSaleItems        FlashSaleItem[]
  inventory             Inventory?
  orderItems            OrderItem[]
  ProductCategory       ProductCategory[]
  features              ProductFeature[]
  inBoxItems            ProductInBox[]
  specifications        ProductSpecification[]
  shippingPolicy        ShippingPolicy?         @relation(fields: [shippingPolicyId], references: [id])
  vendor                Vendor                  @relation(fields: [vendorId], references: [id], onDelete: Cascade)
  RecentlyViewedProduct RecentlyViewedProduct[]
  reviews               Review[]
  shippingOptions       ShippingOption[]
  wishlistItems         WishlistItem[]
  category              Category[]              @relation("ProductCategories")

  @@map("products")
}

model Inventory {
  id                String   @id @default(uuid())
  productId         String   @unique
  vendorId          String
  quantity          Int      @default(0)
  lowStockThreshold Int      @default(10)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  product           Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  vendor            Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@map("inventory")
}

model RecentlyViewedProduct {
  id        String   @id @default(uuid())
  userId    String?
  sessionId String?
  productId String
  viewedAt  DateTime @default(now())
  product   Product  @relation(fields: [productId], references: [id])
  user      User?    @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([sessionId])
  @@index([viewedAt])
  @@map("recently_viewed_products")
}

model ProductVariant {
  id            String      @id @default(uuid())
  productId     String
  color         String
  size          String
  price         Float
  quantity      Int
  inStock       Boolean     @default(true)
  discountPrice Float?
  product       Product     @relation(fields: [productId], references: [id])
  CartItem      CartItem[]
  OrderItem     OrderItem[]
}

model ProductCategory {
  id         String   @id @default(uuid())
  productId  String
  categoryId String
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  product    Product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([productId, categoryId])
  @@map("product_categories")
}

model ShippingOption {
  id           String  @id @default(uuid())
  name         String
  price        Float
  productId    String
  isActive     Boolean @default(true)
  deliveryTime String
  product      Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("shipping_options")
}

model ProductFeature {
  id         String  @id @default(uuid())
  text       String
  attributes Json?
  productId  String
  product    Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_features")
}

model ProductSpecification {
  id         String  @id @default(uuid())
  name       String
  value      String
  attributes Json?
  productId  String
  product    Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_specifications")
}

model ProductInBox {
  id         String  @id @default(uuid())
  item       String
  attributes Json?
  productId  String
  product    Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_in_box_items")
}
