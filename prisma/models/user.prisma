model User {
  id                    String                  @id @default(uuid())
  email                 String                  @unique
  password              String?
  firstName             String?
  lastName              String?
  phone                 String?
  avatar                String?
  role                  UserRole                @default(BUYER)
  isActive              Boolean                 @default(true)
  emailVerified         Boolean                 @default(false)
  department            String?
  team                  String?
  permissionLevel       Int                     @default(0)
  googleId              String?                 @unique
  facebookId            String?                 @unique
  createdAt             DateTime                @default(now())
  updatedAt             DateTime                @updatedAt
  paymentMethods        PaymentMethod[]
  appleId               String?                 @unique
  lastLogin             DateTime?
  resetToken            String?
  resetTokenExpiry      DateTime?
  status                UserStatus              @default(ACTIVE)
  vendorApplicationId   String?
  verificationToken     String?
  assignedCity          String?
  assignedState         String?
  assignedCountry       String?
  assignedRegion        String?
  AdUserInteraction     AdUserInteraction[]
  reviewedAds           Advertisement[]         @relation("AdReviewer")
  adClicks              AdClick[]
  adConversions         AdConversion[]
  adImpressions         AdImpression[]
  addresses             Address[]
  auditLogs             AuditLog[]
  cart                  Cart?
  Category              Category[]
  comments              Comment[]
  deliveries            Delivery[]
  messageReactions      MessageReaction[]       @relation("MessageReactions")
  sentMessages          Message[]               @relation("SentMessages")
  notifications         Notification[]
  orderItems            OrderItem[]
  orders                Order[]                 @relation("UserOrders")
  payments              Payment[]
  profile               Profile?
  RecentlyViewedProduct RecentlyViewedProduct[]
  reviews               Review[]
  riderApplication      RiderApplication?
  rider                 Rider?
  sharedByAddresses     SharedAddress[]         @relation("SharedByUser")
  sharedAddresses       SharedAddress[]         @relation("SharedWithUser")
  shippingAddresses     ShippingAddress[]
  subAdminProfile       SubAdminProfile?
  supportTickets        SupportTicket[]
  settings              UserSettings?
  userTokens            UserTokens[]
  vendorApplication     VendorApplication?      @relation(fields: [vendorApplicationId], references: [id])
  vendor                Vendor?
  wishlistItems         WishlistItem[]
  positions             Position[]              @relation("UserPositions")

  @@map("users")
}

model Profile {
  id          String    @id @default(uuid())
  bio         String?
  gender      Gender?
  avatar      String?
  userId      String    @unique
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  dateOfBirth DateTime?
  interests   String[]
  location    String?
  occupation  String?
  socialLinks Json?
  website     String?
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("profiles")
}

model Address {
  id         String   @id @default(uuid())
  street     String
  city       String
  state      String
  postalCode String
  country    String
  isDefault  Boolean  @default(false)
  userId     String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  latitude   Float?
  longitude  Float?
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  orders     Order[]

  @@map("addresses")
}

model UserTokens {
  id               String   @id @default(uuid())
  refreshToken     String   @unique
  accessToken      String   @unique
  userId           String
  refreshExpiresAt DateTime
  accessExpiresAt  DateTime
  createdAt        DateTime @default(now())
  user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_tokens")
}

model UserSettings {
  id                     String   @id @default(uuid())
  userId                 String   @unique
  language               String   @default("en")
  currency               String   @default("USD")
  darkMode               Boolean  @default(false)
  emailNotifications     Boolean  @default(true)
  pushNotifications      Boolean  @default(true)
  smsNotifications       Boolean  @default(false)
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  adPreferences          Json?
  marketingEmails        Boolean  @default(true)
  privacySettings        Json?
  accountActivityEmails  Boolean  @default(true)
  chatNotifications      Boolean  @default(true)
  newProductEmails       Boolean  @default(false)
  promotionNotifications Boolean  @default(false)
  user                   User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_settings")
}

model AdClick {
  id              String        @id @default(uuid())
  userId          String
  advertisementId String
  platform        AdPlatform
  deviceType      String?
  browser         String?
  ipAddress       String?
  location        String?
  timestamp       DateTime      @default(now())
  advertisement   Advertisement @relation(fields: [advertisementId], references: [id], onDelete: Cascade)
  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("ad_clicks")
}

model AdImpression {
  id              String        @id @default(uuid())
  userId          String?
  advertisementId String
  platform        AdPlatform
  deviceType      String?
  browser         String?
  ipAddress       String?
  location        String?
  timestamp       DateTime      @default(now())
  advertisement   Advertisement @relation(fields: [advertisementId], references: [id], onDelete: Cascade)
  user            User?         @relation(fields: [userId], references: [id])

  @@map("ad_impressions")
}

model AdConversion {
  id              String        @id @default(uuid())
  userId          String
  advertisementId String
  platform        AdPlatform
  conversionType  String
  conversionValue Float?
  orderId         String?
  productId       String?
  deviceType      String?
  browser         String?
  timestamp       DateTime      @default(now())
  advertisement   Advertisement @relation(fields: [advertisementId], references: [id], onDelete: Cascade)
  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("ad_conversions")
}

enum UserRole {
  ADMIN
  SUB_ADMIN
  VENDOR
  BUYER
  RIDER
}

enum Gender {
  MALE
  FEMALE
  OTHER
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  BANNED
}
